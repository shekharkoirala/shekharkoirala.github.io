<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Install Cuda 12.2 in Ubuntu 24.04 | shekhar's Blog</title>
<meta name=keywords content="Nvidia,CUDA,UBUNTU,24-04,drivers,pyenv,pipenv,poetry,cuDNN"><meta name=description content="Learn how to install CUDA 12.2 on Ubuntu 24.04. Follow our step-by-step guide to set up NVIDIA drivers, CUDA Toolkit, and manage Python environments with Pyenv, Pipenv, and Poetry."><meta name=author content="shekhar"><link rel=canonical href=https://shekharkoirala.github.io/posts/nvidia_cuda_ubuntu1/><meta name=google-site-verification content="UA-168093774-1"><link crossorigin=anonymous href=/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as=style><link rel=icon href=https://shekharkoirala.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://shekharkoirala.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://shekharkoirala.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://shekharkoirala.github.io/apple-touch-icon.png><link rel=mask-icon href=https://shekharkoirala.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://shekharkoirala.github.io/posts/nvidia_cuda_ubuntu1/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-168093774-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Install Cuda 12.2 in Ubuntu 24.04"><meta property="og:description" content="Learn how to install CUDA 12.2 on Ubuntu 24.04. Follow our step-by-step guide to set up NVIDIA drivers, CUDA Toolkit, and manage Python environments with Pyenv, Pipenv, and Poetry."><meta property="og:type" content="article"><meta property="og:url" content="https://shekharkoirala.github.io/posts/nvidia_cuda_ubuntu1/"><meta property="og:image" content="https://shekharkoirala.github.io/images/cuda-installation-ubuntu24.04.jpeg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-16T10:56:06+01:00"><meta property="article:modified_time" content="2024-08-16T10:56:06+01:00"><meta property="og:site_name" content="DumpDocs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shekharkoirala.github.io/images/cuda-installation-ubuntu24.04.jpeg"><meta name=twitter:title content="Install Cuda 12.2 in Ubuntu 24.04"><meta name=twitter:description content="Learn how to install CUDA 12.2 on Ubuntu 24.04. Follow our step-by-step guide to set up NVIDIA drivers, CUDA Toolkit, and manage Python environments with Pyenv, Pipenv, and Poetry."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://shekharkoirala.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Install Cuda 12.2 in Ubuntu 24.04","item":"https://shekharkoirala.github.io/posts/nvidia_cuda_ubuntu1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Install Cuda 12.2 in Ubuntu 24.04","name":"Install Cuda 12.2 in Ubuntu 24.04","description":"Learn how to install CUDA 12.2 on Ubuntu 24.04. Follow our step-by-step guide to set up NVIDIA drivers, CUDA Toolkit, and manage Python environments with Pyenv, Pipenv, and Poetry.","keywords":["Nvidia","CUDA","UBUNTU","24-04","drivers","pyenv","pipenv","poetry","cuDNN"],"articleBody":"MOTIVE So, Ubuntu 24.04 LTS was released on 25 April 2024. Its been more 3 months from the release and I thought it would be safe enough to install it in my main working computer. Wrong!! I wanted a documentation for setting up the CUDA 12.2 in Ubuntu 24.04 but ended for reinstalling everything. Thus, here is the blog for future me to setup everything. Thanks to all the great help I found in the Internet [ referenced as links ].\nUbuntu Drivers: At first glance, it was nice and clean. I really the ubuntu drivers, may be it was in the ubuntu 22.x or 20.04.\n1 sudo ubuntu-drivers list 1 2 3 4 5 6 7 8 9 10 11 nvidia-driver-520, (kernel modules provided by nvidia-dkms-520) nvidia-driver-470-server, (kernel modules provided by linux-modules-nvidia-470-server-generic-hwe-24.04) nvidia-driver-555, (kernel modules provided by nvidia-dkms-555) nvidia-driver-470, (kernel modules provided by linux-modules-nvidia-470-generic-hwe-24.04) nvidia-driver-535-server, (kernel modules provided by linux-modules-nvidia-535-server-generic-hwe-24.04) nvidia-driver-515, (kernel modules provided by nvidia-dkms-515) nvidia-driver-550, (kernel modules provided by linux-modules-nvidia-550-generic-hwe-24.04) nvidia-driver-525, (kernel modules provided by nvidia-dkms-525) nvidia-driver-535, (kernel modules provided by linux-modules-nvidia-535-generic-hwe-24.04) nvidia-driver-545, (kernel modules provided by nvidia-dkms-545) nvidia-driver-560, (kernel modules provided by nvidia-dkms-560) \u003c The result might be different for the fresh out of the box Ubuntu \u003e\nand the best advertised part was :\n1 2 sudo ubuntu-drivers autoinstall # It will install the best latest version for your device. haha But, it is great to have all the nvidia-drivers installed right after the fresh OS update. cherry on top, NVIDIA-SMI works. Now, I only need to install libraries like cuda and cudnn for AI/ML pipeline.\nInstalling Nvidia CUDA Before Installing the CUDA, check the compalibility table. Nvida CUDA Compability and Table\nso, I chose (CUDA 12.2) as the nvidia driver 535.54.03+ was already installed on. Now to install the CUDA, Nvidia gave you three options based on the Architecture and Distribution selected: Nvidia CUDA installation\nBut wait, there is no ubuntu 24.04 version. So, You can‚Äôt run the network options or runfile. You have to rely on the 22.04 version deb local method.\nso I followed the following instruction method. Note: I had added the -12-2, otherwise it was installing the latest CUDA, which was 12.6\n1 2 3 4 5 6 7 8 9 sudo apt-get install linux-headers-$(uname -r) sudo apt-key del 7fa2af80 wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64/cuda-ubuntu2204.pin sudo mv cuda-ubuntu2204.pin /etc/apt/preferences.d/cuda-repository-pin-600 wget https://developer.download.nvidia.com/compute/cuda/12.2.2/local_installers/cuda-repo-ubuntu2204-12-2-local_12.2.2-535.104.05-1_amd64.deb sudo dpkg -i cuda-repo-ubuntu2204-12-2-local_12.2.2-535.104.05-1_amd64.deb sudo cp /var/cuda-repo-ubuntu2204-12-2-local/cuda-*-keyring.gpg /usr/share/keyrings/ sudo apt-get update sudo apt-get -y install cuda-12-2 Here, the problem starts, it won‚Äôt install the cuda as it requires Nvidia-driver 560.x, and you have 535.x.\nInstalling latest or any Nvidia Driver version in Ubuntu [RabbitHole] At this point, I thought lets install Nvidia-driver 560.x. I found a really well documented guide: If Not Trye Then False‚Äôs Guide for Install Nvidia Driver\nThis thing is great, but I have question for you. Do you know Nvidia Optimus ? what is Initramfs / prime-select / run level 3 / gdm3 / lightdm / DKMS / MODPROBE / Wayland / X org ?\nif not, dont go in the rabbithole as you might end up having problem with it. if you want to learn about it : Nvidia Optimus: a comfy guide Luckily the above guide have section : if you see Black Screen after Nvidia drivers install, then check following video\nManuall DPKG Nvidia Driver installation Eventually, the better way to install the CUDA was to dont trust the Ubuntu for the Nvidia Drivers. Based on the great post\n1 2 sudo dpkg --force-all -P nvidia-firmware-535-535.54.03 nvidia-kernel-common-535 nvidia-compute-utils-535 sudo apt --fix-broken install Yes, you break the system and then fix the broken. Luckily, there was no black screen when I was doing this. And I am also\ncheck Nvidia-smi, you should have Nvidia 535.x installed.\nNow you could run the above code:\n1 2 3 sudo dpkg -i cuda-repo-ubuntu2204-12-2-local_12.2.2-535.104.05-1_amd64.deb sudo apt update sudo apt install cuda solving CUDA dependencies: libtinfo5 if you have problem with libtinfo5, Based on the site: libtinfo5\n1 2 3 4 5 6 7 8 9 sudo apt install software-properties-common curl -O http://launchpadlibrarian.net/648013231/libtinfo5_6.4-2_amd64.deb curl -O http://launchpadlibrarian.net/648013227/libncurses5_6.4-2_amd64.deb sudo dpkg -i libtinfo5_6.4-2_amd64.deb sudo dpkg -i libncurses5_6.4-2_amd64.deb sudo apt install libnss3-tools curl -O http://launchpadlibrarian.net/646633572/libaio1_0.3.113-4_amd64.deb sudo dpkg -i libaio1_0.3.113-4_amd64.deb sudo apt install cuda-12-2 It should run and add this to ~/.profile\n1 2 3 4 5 # set PATH for cuda 12.2 installation if [ -d \"/usr/local/cuda-12.2/bin/\" ]; then export PATH=/usr/local/cuda-12.2/bin${PATH:+:${PATH}} export LD_LIBRARY_PATH=/usr/local/cuda-12.2/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}} fi That should give you nvcc version\n1 2 . ~/.profile nvcc --version 1 2 3 4 5 nvcc: NVIDIA (R) Cuda compiler driver Copyright (c) 2005-2023 NVIDIA Corporation Built on Tue_Aug_15_22:02:13_PDT_2023 Cuda compilation tools, release 12.2, V12.2.140 Build cuda_12.2.r12.2/compiler.33191640_0 You can install cuDNN if you are into training Neural Network, check the compability version of cuDNN again: compability matrix\n1 sudo apt install cudnn9 And thats all you need.\nBonus: 1. Installing Pyenv in the Fresh Ubuntu 24.04 Yes, in Ubuntu right out of the box, Pyenv installation won‚Äôt work. You need to add following Prerequists:\n1 sudo apt install -y make build-essential libssl-dev zlib1g-dev libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm libncursesw5-dev xz-utils tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev then\n1 2 3 4 5 6 7 curl https://pyenv.run | bash echo 'export PYENV_ROOT=\"$HOME/.pyenv\"' \u003e\u003e ~/.zshrc^Jecho '[[ -d $PYENV_ROOT/bin ]] \u0026\u0026 export PATH=\"$PYENV_ROOT/bin:$PATH\"' \u003e\u003e ~/.zshrc^Jecho 'eval \"$(pyenv init -)\"' \u003e\u003e ~/.zshrc exec zsh sudo apt install python3-pip pyenv install 3.13 pyenv install 3.12 pyenv install 3.11 and so on ..\n2. Installing Virtualenv in the Fresh Ubuntu 24.04 Pipenv\n1 2 3 4 sudo apt install software-properties-common python-software-properties sudo add-apt-repository ppa:pypa/ppa sudo apt update sudo apt install pipenv Poetry:\n1 curl -sSL https://install.python-poetry.org | python3 - 3. Checking Cuda with Pytorch Script. Here is a small script to test the GPU and the packages. You need to install Torch, Torchvision , Numpy to run the script. You can use the latest packages for this.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 import torchvision import torch import traceback tcuda: torch.cuda = torch.cuda print(f\"How many gpu in the server ? -\u003e {tcuda.device_count()}\") print(f\"can torch access {tcuda.device_count()} GPUs? :\u003e {tcuda.is_available()}\") print(f\"Attempting to access GPU device name : {tcuda.current_device()} ....\") try: model = torchvision.models.detection.retinanet_resnet50_fpn(pretrained=True) model.cuda() model.eval() x = [torch.rand(3, 300, 400).cuda(), torch.rand(3, 500, 400).cuda()] predictions = model(x) print(predictions) print(f\"is torch gpu is initialized ? :\u003e {tcuda.is_initialized()}\") print(f\"torch cuda memory summary :\u003e {tcuda.memory_summary()}\") print(f\"memory reserved {tcuda.memory_reserved()}\") print(f\"memory allocated {tcuda.memory_allocated()}\") except Exception as e: print(e) print(\"No CUDA available\") traceback.print_exc() 4. setting up the Terminal ZSH Install Some cool Nerd Fonts\nInstall zsh and oh my zsh and Terminator\n1 2 3 sudo apt install zsh sudo apt install terminator sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\" Install Oh my zsh plugins\n1 2 3 4 git clone https://github.com/zsh-users/zsh-autosuggestions.git $ZSH_CUSTOM/plugins/zsh-autosuggestions git clone https://github.com/zsh-users/zsh-syntax-highlighting.git $ZSH_CUSTOM/plugins/zsh-syntax-highlighting git clone https://github.com/zdharma-continuum/fast-syntax-highlighting.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/plugins/fast-syntax-highlighting git clone --depth 1 -- https://github.com/marlonrichert/zsh-autocomplete.git $ZSH_CUSTOM/plugins/zsh-autocomplete Install Powerlevel10k\n1 git clone --depth=1 https://github.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k Update this in the ~/.zshrc\n1 2 ZSH_THEME=\"powerlevel10k/powerlevel10k\" plugins=(git zsh-autosuggestions zsh-syntax-highlighting fast-syntax-highlighting zsh-autocomplete python) and update the zshrc and setup the theme\n1 2 3 nano ~/.zshrc exec zsh p10k configure Atuin 1 2 3 4 5 curl --proto '=https' --tlsv1.2 -LsSf https://setup.atuin.sh | sh atuin login source $HOME/.atuin/bin/env atuin login atuin sync Handle SSH I prefer to run multiple ssh key in a single machine and it is handled by a ssh config file.\ncat config\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 #Default GitHub Host github.com HostName github.com User git IdentityFile ~/.ssh/id_rsa Host github-mac HostName github.com User git IdentityFile ~/.ssh/id_rsa_personal Host gitlab HostName gilab.com IdentityFile ~/.ssh/id_rsa_personal id_rsa could be your one key and id_rsa_personal could be your personal / other github user.\n1 2 3 4 5 cd ./ssh sudo cp /home/shekhar/Downloads/ssh/. . ssh -T git@github.com ssh-add id_rsa ssh-add id_rsa_personal ","wordCount":"1300","inLanguage":"en","image":"https://shekharkoirala.github.io/images/cuda-installation-ubuntu24.04.jpeg","datePublished":"2024-08-16T10:56:06+01:00","dateModified":"2024-08-16T10:56:06+01:00","author":{"@type":"Person","name":"shekhar"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://shekharkoirala.github.io/posts/nvidia_cuda_ubuntu1/"},"publisher":{"@type":"Organization","name":"shekhar's Blog","logo":{"@type":"ImageObject","url":"https://shekharkoirala.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://shekharkoirala.github.io/ accesskey=h title="shekhar's Blog (Alt + H)">shekhar's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://shekharkoirala.github.io/archives title="Post üìù"><span>Post üìù</span></a></li><li><a href=https://shekharkoirala.github.io/categories/ title="Categories üîñ"><span>Categories üîñ</span></a></li><li><a href=https://shekharkoirala.github.io/tags/ title="Tags üè∑Ô∏è"><span>Tags üè∑Ô∏è</span></a></li><li><a href=https://shekharkoirala.github.io/about title="About üßò"><span>About üßò</span></a></li><li><a href=https://shekharkoirala.github.io/search/ title=üîç><span>üîç</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://shekharkoirala.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://shekharkoirala.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Install Cuda 12.2 in Ubuntu 24.04</h1><div class=post-description>Learn how to install CUDA 12.2 on Ubuntu 24.04. Follow our step-by-step guide to set up NVIDIA drivers, CUDA Toolkit, and manage Python environments with Pyenv, Pipenv, and Poetry.</div><div class=post-meta><span title='2024-08-16 10:56:06 +0100 IST'>August 16, 2024</span>&nbsp;¬∑&nbsp;7 min&nbsp;¬∑&nbsp;shekhar&nbsp;|&nbsp;<a href=mailto:shekharkoirala4@gmail.com rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#motive aria-label=MOTIVE>MOTIVE</a><ul><li><a href=#ubuntu-drivers aria-label="Ubuntu Drivers:">Ubuntu Drivers:</a></li><li><a href=#installing-nvidia-cuda aria-label="Installing Nvidia CUDA">Installing Nvidia CUDA</a><ul><li><a href=#installing-latest-or-any-nvidia-driver-version-in-ubuntu-rabbithole aria-label="Installing latest or any Nvidia Driver version in Ubuntu [RabbitHole]">Installing latest or any Nvidia Driver version in Ubuntu [RabbitHole]</a></li><li><a href=#manuall-dpkg-nvidia-driver-installation aria-label="Manuall DPKG Nvidia Driver installation">Manuall DPKG Nvidia Driver installation</a></li><li><a href=#solving-cuda-dependencies-libtinfo5 aria-label="solving CUDA dependencies: libtinfo5">solving CUDA dependencies: libtinfo5</a></li></ul></li></ul></li><li><a href=#bonus aria-label=Bonus:>Bonus:</a><ul><li><a href=#1-installing-pyenv-in-the-fresh-ubuntu-2404 aria-label="1. Installing Pyenv in the Fresh Ubuntu 24.04">1. Installing Pyenv in the Fresh Ubuntu 24.04</a></li><li><a href=#2-installing-virtualenv-in-the-fresh-ubuntu-2404 aria-label="2. Installing Virtualenv in the Fresh Ubuntu 24.04">2. Installing Virtualenv in the Fresh Ubuntu 24.04</a></li><li><a href=#3-checking-cuda-with-pytorch-script aria-label="3. Checking Cuda with Pytorch Script.">3. Checking Cuda with Pytorch Script.</a></li><li><a href=#4-setting-up-the-terminal aria-label="4. setting up the Terminal">4. setting up the Terminal</a><ul><li><a href=#zsh aria-label=ZSH>ZSH</a></li><li><a href=#atuin aria-label=Atuin>Atuin</a></li><li><a href=#handle-ssh aria-label="Handle SSH">Handle SSH</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><h1 id=motive>MOTIVE<a hidden class=anchor aria-hidden=true href=#motive>#</a></h1><p>So, Ubuntu 24.04 LTS was released on 25 April 2024. Its been more 3 months from the release and I thought it would be safe enough to install it in my main working computer. Wrong!!
I wanted a documentation for setting up the CUDA 12.2 in Ubuntu 24.04 but ended for reinstalling everything. Thus, here is the blog for future me to setup everything. Thanks to all the great help I found in the Internet [ referenced as links ].</p><h2 id=ubuntu-drivers>Ubuntu Drivers:<a hidden class=anchor aria-hidden=true href=#ubuntu-drivers>#</a></h2><p>At first glance, it was nice and clean. I really the ubuntu drivers, may be it was in the ubuntu 22.x or 20.04.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ubuntu-drivers list
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nvidia-driver-520, <span class=o>(</span>kernel modules provided by nvidia-dkms-520<span class=o>)</span>
</span></span><span class=line><span class=cl>nvidia-driver-470-server, <span class=o>(</span>kernel modules provided by linux-modules-nvidia-470-server-generic-hwe-24.04<span class=o>)</span>
</span></span><span class=line><span class=cl>nvidia-driver-555, <span class=o>(</span>kernel modules provided by nvidia-dkms-555<span class=o>)</span>
</span></span><span class=line><span class=cl>nvidia-driver-470, <span class=o>(</span>kernel modules provided by linux-modules-nvidia-470-generic-hwe-24.04<span class=o>)</span>
</span></span><span class=line><span class=cl>nvidia-driver-535-server, <span class=o>(</span>kernel modules provided by linux-modules-nvidia-535-server-generic-hwe-24.04<span class=o>)</span>
</span></span><span class=line><span class=cl>nvidia-driver-515, <span class=o>(</span>kernel modules provided by nvidia-dkms-515<span class=o>)</span>
</span></span><span class=line><span class=cl>nvidia-driver-550, <span class=o>(</span>kernel modules provided by linux-modules-nvidia-550-generic-hwe-24.04<span class=o>)</span>
</span></span><span class=line><span class=cl>nvidia-driver-525, <span class=o>(</span>kernel modules provided by nvidia-dkms-525<span class=o>)</span>
</span></span><span class=line><span class=cl>nvidia-driver-535, <span class=o>(</span>kernel modules provided by linux-modules-nvidia-535-generic-hwe-24.04<span class=o>)</span>
</span></span><span class=line><span class=cl>nvidia-driver-545, <span class=o>(</span>kernel modules provided by nvidia-dkms-545<span class=o>)</span>
</span></span><span class=line><span class=cl>nvidia-driver-560, <span class=o>(</span>kernel modules provided by nvidia-dkms-560<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><p>&lt; The result might be different for the fresh out of the box Ubuntu ></p><p>and the best advertised part was :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ubuntu-drivers autoinstall
</span></span><span class=line><span class=cl><span class=c1># It will install the best latest version for your device.  haha</span>
</span></span></code></pre></td></tr></table></div></div><p>But, it is great to have all the nvidia-drivers installed right after the fresh OS update. cherry on top, NVIDIA-SMI works. Now, I only need to install libraries like cuda and cudnn for AI/ML pipeline.</p><h2 id=installing-nvidia-cuda>Installing Nvidia CUDA<a hidden class=anchor aria-hidden=true href=#installing-nvidia-cuda>#</a></h2><p>Before Installing the CUDA, check the compalibility table.
<a href=https://docs.nvidia.com/deploy/cuda-compatibility/>Nvida CUDA Compability</a>
and <a href=https://docs.nvidia.com/deploy/cuda-compatibility/#id3>Table</a></p><p>so, I chose (CUDA 12.2) as the nvidia driver 535.54.03+ was already installed on. Now to install the CUDA, Nvidia gave you three options based on the Architecture and Distribution selected:
<a href="https://developer.nvidia.com/cuda-12-2-2-download-archive?target_os=Linux&target_arch=x86_64&Distribution=Ubuntu&target_version=22.04&target_type=deb_local">Nvidia CUDA installation</a></p><p>But wait, there is no ubuntu 24.04 version. So, You can&rsquo;t run the network options or runfile. You have to rely on the 22.04 version deb local method.</p><p>so I followed the following instruction method.
Note: I had added the -12-2, otherwise it was installing the latest CUDA, which was 12.6</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install linux-headers-<span class=k>$(</span>uname -r<span class=k>)</span>
</span></span><span class=line><span class=cl>sudo apt-key del 7fa2af80
</span></span><span class=line><span class=cl>wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64/cuda-ubuntu2204.pin
</span></span><span class=line><span class=cl>sudo mv cuda-ubuntu2204.pin /etc/apt/preferences.d/cuda-repository-pin-600
</span></span><span class=line><span class=cl>wget https://developer.download.nvidia.com/compute/cuda/12.2.2/local_installers/cuda-repo-ubuntu2204-12-2-local_12.2.2-535.104.05-1_amd64.deb
</span></span><span class=line><span class=cl>sudo dpkg -i cuda-repo-ubuntu2204-12-2-local_12.2.2-535.104.05-1_amd64.deb
</span></span><span class=line><span class=cl>sudo cp /var/cuda-repo-ubuntu2204-12-2-local/cuda-*-keyring.gpg /usr/share/keyrings/
</span></span><span class=line><span class=cl>sudo apt-get update
</span></span><span class=line><span class=cl>sudo apt-get -y install cuda-12-2
</span></span></code></pre></td></tr></table></div></div><p>Here, the problem starts, it won&rsquo;t install the cuda as it requires Nvidia-driver 560.x, and you have 535.x.</p><h3 id=installing-latest-or-any-nvidia-driver-version-in-ubuntu-rabbithole>Installing latest or any Nvidia Driver version in Ubuntu [RabbitHole]<a hidden class=anchor aria-hidden=true href=#installing-latest-or-any-nvidia-driver-version-in-ubuntu-rabbithole>#</a></h3><p>At this point, I thought lets install Nvidia-driver 560.x. I found a really well documented guide: <a href=https://www.if-not-true-then-false.com/2021/debian-ubuntu-linux-mint-nvidia-guide>If Not Trye Then False&rsquo;s Guide for Install Nvidia Driver</a></p><p>This thing is great, but I have question for you.
Do you know Nvidia Optimus ? what is Initramfs / prime-select / run level 3 / gdm3 / lightdm / DKMS / MODPROBE / Wayland / X org ?</p><p>if not, dont go in the rabbithole as you might end up having problem with it.
if you want to learn about it : <a href="https://www.youtube.com/watch?v=Pn2iUgW3l6w">Nvidia Optimus: a comfy guide</a><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/Pn2iUgW3l6w style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div>Luckily the above guide have section : if you see Black Screen after Nvidia drivers install, then check following <a href="https://www.youtube.com/watch?v=3vcOqqSS8xc">video</a></p><h3 id=manuall-dpkg-nvidia-driver-installation>Manuall DPKG Nvidia Driver installation<a hidden class=anchor aria-hidden=true href=#manuall-dpkg-nvidia-driver-installation>#</a></h3><p>Eventually, the better way to install the CUDA was to dont trust the Ubuntu for the Nvidia Drivers. Based on the great <a href=https://forums.developer.nvidia.com/t/ubuntu-and-nvidia-provided-packages-conflict-breaking-installation/259150>post</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> sudo dpkg --force-all -P nvidia-firmware-535-535.54.03 nvidia-kernel-common-535 nvidia-compute-utils-535
</span></span><span class=line><span class=cl> sudo apt --fix-broken install
</span></span></code></pre></td></tr></table></div></div><p>Yes, you break the system and then fix the broken. Luckily, there was no black screen when I was doing this.
And I am also</p><p>check Nvidia-smi, you should have Nvidia 535.x installed.</p><p>Now you could run the above code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo dpkg -i cuda-repo-ubuntu2204-12-2-local_12.2.2-535.104.05-1_amd64.deb
</span></span><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install cuda 
</span></span></code></pre></td></tr></table></div></div><h3 id=solving-cuda-dependencies-libtinfo5>solving CUDA dependencies: libtinfo5<a hidden class=anchor aria-hidden=true href=#solving-cuda-dependencies-libtinfo5>#</a></h3><p>if you have problem with libtinfo5, Based on the site: <a href=https://community.localwp.com/t/installation-failed-in-ubuntu-24-04-lts/42579>libtinfo5</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install software-properties-common
</span></span><span class=line><span class=cl>curl -O http://launchpadlibrarian.net/648013231/libtinfo5_6.4-2_amd64.deb
</span></span><span class=line><span class=cl>curl -O http://launchpadlibrarian.net/648013227/libncurses5_6.4-2_amd64.deb
</span></span><span class=line><span class=cl>sudo dpkg -i libtinfo5_6.4-2_amd64.deb
</span></span><span class=line><span class=cl>sudo dpkg -i libncurses5_6.4-2_amd64.deb
</span></span><span class=line><span class=cl>sudo apt install libnss3-tools
</span></span><span class=line><span class=cl>curl -O http://launchpadlibrarian.net/646633572/libaio1_0.3.113-4_amd64.deb
</span></span><span class=line><span class=cl>sudo dpkg -i libaio1_0.3.113-4_amd64.deb
</span></span><span class=line><span class=cl>sudo apt install cuda-12-2     
</span></span></code></pre></td></tr></table></div></div><p>It should run and add this to ~/.profile</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># set PATH for cuda 12.2 installation</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> -d <span class=s2>&#34;/usr/local/cuda-12.2/bin/&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span>/usr/local/cuda-12.2/bin<span class=si>${</span><span class=nv>PATH</span><span class=p>:+:</span><span class=si>${</span><span class=nv>PATH</span><span class=si>}}</span>
</span></span><span class=line><span class=cl>    <span class=nb>export</span> <span class=nv>LD_LIBRARY_PATH</span><span class=o>=</span>/usr/local/cuda-12.2/lib64<span class=si>${</span><span class=nv>LD_LIBRARY_PATH</span><span class=p>:+:</span><span class=si>${</span><span class=nv>LD_LIBRARY_PATH</span><span class=si>}}</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></td></tr></table></div></div><p>That should give you nvcc version</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/.profile
</span></span><span class=line><span class=cl>nvcc --version
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nvcc: NVIDIA <span class=o>(</span>R<span class=o>)</span> Cuda compiler driver
</span></span><span class=line><span class=cl>Copyright <span class=o>(</span>c<span class=o>)</span> 2005-2023 NVIDIA Corporation
</span></span><span class=line><span class=cl>Built on Tue_Aug_15_22:02:13_PDT_2023
</span></span><span class=line><span class=cl>Cuda compilation tools, release 12.2, V12.2.140
</span></span><span class=line><span class=cl>Build cuda_12.2.r12.2/compiler.33191640_0
</span></span></code></pre></td></tr></table></div></div><p>You can install cuDNN if you are into training Neural Network, check the compability version of cuDNN again: <a href=https://docs.nvidia.com/deeplearning/cudnn/latest/reference/support-matrix.html>compability matrix</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install cudnn9
</span></span></code></pre></td></tr></table></div></div><p>And thats all you need.</p><h1 id=bonus>Bonus:<a hidden class=anchor aria-hidden=true href=#bonus>#</a></h1><h2 id=1-installing-pyenv-in-the-fresh-ubuntu-2404>1. Installing Pyenv in the Fresh Ubuntu 24.04<a hidden class=anchor aria-hidden=true href=#1-installing-pyenv-in-the-fresh-ubuntu-2404>#</a></h2><p>Yes, in Ubuntu right out of the box, Pyenv installation won&rsquo;t work.
You need to add following Prerequists:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install -y make build-essential libssl-dev zlib1g-dev libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm libncursesw5-dev xz-utils tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev
</span></span></code></pre></td></tr></table></div></div><p>then</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl https://pyenv.run <span class=p>|</span> bash
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;export PYENV_ROOT=&#34;$HOME/.pyenv&#34;&#39;</span> &gt;&gt; ~/.zshrc^Jecho <span class=s1>&#39;[[ -d $PYENV_ROOT/bin ]] &amp;&amp; export PATH=&#34;$PYENV_ROOT/bin:$PATH&#34;&#39;</span> &gt;&gt; ~/.zshrc^Jecho <span class=s1>&#39;eval &#34;$(pyenv init -)&#34;&#39;</span> &gt;&gt; ~/.zshrc
</span></span><span class=line><span class=cl><span class=nb>exec</span> zsh
</span></span><span class=line><span class=cl>sudo apt install python3-pip
</span></span><span class=line><span class=cl>pyenv install 3.13
</span></span><span class=line><span class=cl>pyenv install 3.12
</span></span><span class=line><span class=cl>pyenv install 3.11
</span></span></code></pre></td></tr></table></div></div><p>and so on ..</p><h2 id=2-installing-virtualenv-in-the-fresh-ubuntu-2404>2. Installing Virtualenv in the Fresh Ubuntu 24.04<a hidden class=anchor aria-hidden=true href=#2-installing-virtualenv-in-the-fresh-ubuntu-2404>#</a></h2><p>Pipenv</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install software-properties-common python-software-properties
</span></span><span class=line><span class=cl>sudo add-apt-repository ppa:pypa/ppa
</span></span><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install pipenv
</span></span></code></pre></td></tr></table></div></div><p>Poetry:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -sSL https://install.python-poetry.org <span class=p>|</span> python3 -
</span></span></code></pre></td></tr></table></div></div><h2 id=3-checking-cuda-with-pytorch-script>3. Checking Cuda with Pytorch Script.<a hidden class=anchor aria-hidden=true href=#3-checking-cuda-with-pytorch-script>#</a></h2><p>Here is a small script to test the GPU and the packages.
You need to install Torch, Torchvision , Numpy to run the script.
You can use the latest packages for this.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torchvision</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>torch</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>traceback</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tcuda</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>cuda</span> <span class=o>=</span> <span class=n>torch</span><span class=o>.</span><span class=n>cuda</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;How many gpu in the server ? -&gt; </span><span class=si>{</span><span class=n>tcuda</span><span class=o>.</span><span class=n>device_count</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;can torch access </span><span class=si>{</span><span class=n>tcuda</span><span class=o>.</span><span class=n>device_count</span><span class=p>()</span><span class=si>}</span><span class=s2> GPUs? :&gt; </span><span class=si>{</span><span class=n>tcuda</span><span class=o>.</span><span class=n>is_available</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Attempting to access GPU device name : </span><span class=si>{</span><span class=n>tcuda</span><span class=o>.</span><span class=n>current_device</span><span class=p>()</span><span class=si>}</span><span class=s2> ....&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span> <span class=o>=</span> <span class=n>torchvision</span><span class=o>.</span><span class=n>models</span><span class=o>.</span><span class=n>detection</span><span class=o>.</span><span class=n>retinanet_resnet50_fpn</span><span class=p>(</span><span class=n>pretrained</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>cuda</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=n>eval</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=p>[</span><span class=n>torch</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>300</span><span class=p>,</span> <span class=mi>400</span><span class=p>)</span><span class=o>.</span><span class=n>cuda</span><span class=p>(),</span> <span class=n>torch</span><span class=o>.</span><span class=n>rand</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>500</span><span class=p>,</span> <span class=mi>400</span><span class=p>)</span><span class=o>.</span><span class=n>cuda</span><span class=p>()]</span>
</span></span><span class=line><span class=cl>    <span class=n>predictions</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>predictions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;is torch gpu is initialized ? :&gt; </span><span class=si>{</span><span class=n>tcuda</span><span class=o>.</span><span class=n>is_initialized</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;torch cuda memory summary :&gt; </span><span class=si>{</span><span class=n>tcuda</span><span class=o>.</span><span class=n>memory_summary</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;memory reserved </span><span class=si>{</span><span class=n>tcuda</span><span class=o>.</span><span class=n>memory_reserved</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;memory allocated </span><span class=si>{</span><span class=n>tcuda</span><span class=o>.</span><span class=n>memory_allocated</span><span class=p>()</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;No CUDA available&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>traceback</span><span class=o>.</span><span class=n>print_exc</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=4-setting-up-the-terminal>4. setting up the Terminal<a hidden class=anchor aria-hidden=true href=#4-setting-up-the-terminal>#</a></h2><h3 id=zsh>ZSH<a hidden class=anchor aria-hidden=true href=#zsh>#</a></h3><p>Install Some cool <a href=https://www.nerdfonts.com/font-downloads>Nerd Fonts</a></p><p>Install zsh and oh my zsh and Terminator</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install zsh
</span></span><span class=line><span class=cl>sudo apt install terminator
</span></span><span class=line><span class=cl>sh -c <span class=s2>&#34;</span><span class=k>$(</span>curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh<span class=k>)</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p>Install Oh my zsh plugins</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/zsh-users/zsh-autosuggestions.git <span class=nv>$ZSH_CUSTOM</span>/plugins/zsh-autosuggestions
</span></span><span class=line><span class=cl>git clone https://github.com/zsh-users/zsh-syntax-highlighting.git <span class=nv>$ZSH_CUSTOM</span>/plugins/zsh-syntax-highlighting
</span></span><span class=line><span class=cl>git clone https://github.com/zdharma-continuum/fast-syntax-highlighting.git <span class=si>${</span><span class=nv>ZSH_CUSTOM</span><span class=k>:-</span><span class=nv>$HOME</span><span class=p>/.oh-my-zsh/custom</span><span class=si>}</span>/plugins/fast-syntax-highlighting
</span></span><span class=line><span class=cl>git clone --depth <span class=m>1</span> -- https://github.com/marlonrichert/zsh-autocomplete.git <span class=nv>$ZSH_CUSTOM</span>/plugins/zsh-autocomplete
</span></span></code></pre></td></tr></table></div></div><p>Install Powerlevel10k</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> git clone --depth<span class=o>=</span><span class=m>1</span> https://github.com/romkatv/powerlevel10k.git <span class=si>${</span><span class=nv>ZSH_CUSTOM</span><span class=k>:-</span><span class=nv>$HOME</span><span class=p>/.oh-my-zsh/custom</span><span class=si>}</span>/themes/powerlevel10k
</span></span></code></pre></td></tr></table></div></div><p>Update this in the ~/.zshrc</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>ZSH_THEME</span><span class=o>=</span><span class=s2>&#34;powerlevel10k/powerlevel10k&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>plugins</span><span class=o>=(</span>git zsh-autosuggestions zsh-syntax-highlighting fast-syntax-highlighting zsh-autocomplete python<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><p>and update the zshrc and setup the theme</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano ~/.zshrc
</span></span><span class=line><span class=cl><span class=nb>exec</span> zsh
</span></span><span class=line><span class=cl>p10k configure
</span></span></code></pre></td></tr></table></div></div><h3 id=atuin>Atuin<a hidden class=anchor aria-hidden=true href=#atuin>#</a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl --proto <span class=s1>&#39;=https&#39;</span> --tlsv1.2 -LsSf https://setup.atuin.sh <span class=p>|</span> sh
</span></span><span class=line><span class=cl>atuin login
</span></span><span class=line><span class=cl><span class=nb>source</span> <span class=nv>$HOME</span>/.atuin/bin/env
</span></span><span class=line><span class=cl>atuin login
</span></span><span class=line><span class=cl>atuin sync
</span></span></code></pre></td></tr></table></div></div><h3 id=handle-ssh>Handle SSH<a hidden class=anchor aria-hidden=true href=#handle-ssh>#</a></h3><p>I prefer to run multiple ssh key in a single machine and it is handled by a ssh config file.</p><p>cat config</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#Default GitHub</span>
</span></span><span class=line><span class=cl>Host github.com
</span></span><span class=line><span class=cl>  HostName github.com
</span></span><span class=line><span class=cl>  User git
</span></span><span class=line><span class=cl>  IdentityFile ~/.ssh/id_rsa
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host github-mac
</span></span><span class=line><span class=cl>  HostName github.com
</span></span><span class=line><span class=cl>  User git
</span></span><span class=line><span class=cl>  IdentityFile ~/.ssh/id_rsa_personal
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host gitlab
</span></span><span class=line><span class=cl>  HostName gilab.com 
</span></span><span class=line><span class=cl>  IdentityFile ~/.ssh/id_rsa_personal
</span></span></code></pre></td></tr></table></div></div><p>id_rsa could be your one key and id_rsa_personal could be your personal / other github user.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ./ssh
</span></span><span class=line><span class=cl>sudo cp /home/shekhar/Downloads/ssh/. . 
</span></span><span class=line><span class=cl>ssh -T git@github.com
</span></span><span class=line><span class=cl>ssh-add id_rsa
</span></span><span class=line><span class=cl>ssh-add id_rsa_personal
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://shekharkoirala.github.io/tags/nvidia/>Nvidia</a></li><li><a href=https://shekharkoirala.github.io/tags/cuda/>CUDA</a></li><li><a href=https://shekharkoirala.github.io/tags/ubuntu/>UBUNTU</a></li><li><a href=https://shekharkoirala.github.io/tags/24-04/>24-04</a></li><li><a href=https://shekharkoirala.github.io/tags/drivers/>Drivers</a></li><li><a href=https://shekharkoirala.github.io/tags/pyenv/>Pyenv</a></li><li><a href=https://shekharkoirala.github.io/tags/pipenv/>Pipenv</a></li><li><a href=https://shekharkoirala.github.io/tags/poetry/>Poetry</a></li><li><a href=https://shekharkoirala.github.io/tags/cudnn/>CuDNN</a></li></ul><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Install Cuda 12.2 in Ubuntu 24.04 on x" href="https://x.com/intent/tweet/?text=Install%20Cuda%2012.2%20in%20Ubuntu%2024.04&amp;url=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fnvidia_cuda_ubuntu1%2f&amp;hashtags=Nvidia%2cCUDA%2cUBUNTU%2c24-04%2cdrivers%2cpyenv%2cpipenv%2cpoetry%2ccuDNN"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Install Cuda 12.2 in Ubuntu 24.04 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fnvidia_cuda_ubuntu1%2f&amp;title=Install%20Cuda%2012.2%20in%20Ubuntu%2024.04&amp;summary=Install%20Cuda%2012.2%20in%20Ubuntu%2024.04&amp;source=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fnvidia_cuda_ubuntu1%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Install Cuda 12.2 in Ubuntu 24.04 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fnvidia_cuda_ubuntu1%2f&title=Install%20Cuda%2012.2%20in%20Ubuntu%2024.04"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Install Cuda 12.2 in Ubuntu 24.04 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fnvidia_cuda_ubuntu1%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Install Cuda 12.2 in Ubuntu 24.04 on whatsapp" href="https://api.whatsapp.com/send?text=Install%20Cuda%2012.2%20in%20Ubuntu%2024.04%20-%20https%3a%2f%2fshekharkoirala.github.io%2fposts%2fnvidia_cuda_ubuntu1%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Install Cuda 12.2 in Ubuntu 24.04 on telegram" href="https://telegram.me/share/url?text=Install%20Cuda%2012.2%20in%20Ubuntu%2024.04&amp;url=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fnvidia_cuda_ubuntu1%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Install Cuda 12.2 in Ubuntu 24.04 on ycombinator" href="https://news.ycombinator.com/submitlink?t=Install%20Cuda%2012.2%20in%20Ubuntu%2024.04&u=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fnvidia_cuda_ubuntu1%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>