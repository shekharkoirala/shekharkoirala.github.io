<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Top 50 SQL for Mastery | shekhar's Blog</title>
<meta name=keywords content="sql,pandas"><meta name=description content="Top 50 SQl questions for your next interview, solutions included both Pandas and SQL"><meta name=author content="shekhar"><link rel=canonical href=https://shekharkoirala.github.io/posts/sql_50/><meta name=google-site-verification content="UA-168093774-1"><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://shekharkoirala.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://shekharkoirala.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://shekharkoirala.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://shekharkoirala.github.io/apple-touch-icon.png><link rel=mask-icon href=https://shekharkoirala.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://shekharkoirala.github.io/posts/sql_50/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://shekharkoirala.github.io/posts/sql_50/"><meta property="og:site_name" content="shekhar's Blog"><meta property="og:title" content="Top 50 SQL for Mastery"><meta property="og:description" content="Top 50 SQl questions for your next interview, solutions included both Pandas and SQL"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-12-25T15:52:11+00:00"><meta property="article:modified_time" content="2024-12-25T15:52:11+00:00"><meta property="article:tag" content="Sql"><meta property="article:tag" content="Pandas"><meta property="og:image" content="https://shekharkoirala.github.io/papermod-cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shekharkoirala.github.io/papermod-cover.png"><meta name=twitter:title content="Top 50 SQL for Mastery"><meta name=twitter:description content="Top 50 SQl questions for your next interview, solutions included both Pandas and SQL"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://shekharkoirala.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Top 50 SQL for Mastery","item":"https://shekharkoirala.github.io/posts/sql_50/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Top 50 SQL for Mastery","name":"Top 50 SQL for Mastery","description":"Top 50 SQl questions for your next interview, solutions included both Pandas and SQL","keywords":["sql","pandas"],"articleBody":" Recyclable and Low Fat Products 1 2 3 def find_products(products: pd.DataFrame) -\u003e pd.DataFrame: # return products[(products[\"low_fats\"] == \"Y\") \u0026 (products[\"recyclable\"] ==\"Y\")].loc[:,[\"product_id\"]] return products[(products[\"low_fats\"] == \"Y\") \u0026 (products[\"recyclable\"] ==\"Y\")][[\"product_id\"]] 1 select product_id from Products where low_fats = \"Y\" and recyclable = \"Y\" Note: can use df.iloc[:, [‚Äúcolumn_name‚Äù]] or df[[‚Äúcolumn_name]] df[‚Äúcolumn_name] returns series.\nFind Customer Refree 1 2 def find_customer_referee(customer: pd.DataFrame) -\u003e pd.DataFrame: return customer[(customer[\"referee_id\"] != 2) | (customer[\"referee_id\"].isnull())][[\"name\"]] or\n1 2 3 def find_customer_referee(customer: pd.DataFrame) -\u003e pd.DataFrame: customer.fillna(0, inplace=True) return customer.loc[customer[\"referee_id\"] !=2 , [\"name\"]] Note: can insert the logic in the loc\n1 select name from Customer where referee_id != 2 or referee_id is Null Big countries 1 2 def big_countries(world: pd.DataFrame) -\u003e pd.DataFrame: return world[(world[\"area\"] \u003e= 3000000) | (world[\"population\"] \u003e 25000000)][[\"name\", \"population\", \"area\"]] 1 select name, population, area from world where population \u003e= 25000000 or area \u003e= 3000000 Article View 1 2 3 def article_views(views: pd.DataFrame) -\u003e pd.DataFrame: return views[views[\"viewer_id\"] == views[\"author_id\"]][[\"author_id\"]].drop_duplicates() .sort_values(\"author_id\").rename(columns={\"author_id\": \"id\"}) 1 select distinct(author_id) as id from Views where author_id = viewer_id order by id invalid tweets 1 select tweet_id from Tweets where length(content) \u003e15 1 2 def invalid_tweets(tweets: pd.DataFrame) -\u003e pd.DataFrame:22 return tweets.query(f\"content.str.len() \u003e15\")[[\"tweet_id\"]] or\n1 return tweets.loc[tweets.content.str.len() \u003e15, [\"tweet_id\"]] Replace Employee id 1 2 def replace_employee_id(employees: pd.DataFrame, employee_uni: pd.DataFrame) -\u003e pd.DataFrame: return pd.merge(employees, employee_uni, how=\"left\", on=[\"id\", \"id\"])[[\"unique_id\", \"name\"]] 1 select unique_id, name from Employees left join EmployeeUNI on Employees.id = EmployeeUNI.id Product Sales Analysis 1 SELECT product_name, year, price from Sales left join Product on Sales.product_id = Product.product_id customer-who-visited-but-did-not-make-any-transactions 1 2 3 SELECT customer_id, COUNT(*) AS count_no_trans FROM Visits LEFT JOIN Transactions ON Visits.visit_id = Transactions.visit_id WHERE transaction_id IS NULL GROUP BY customer_id; ``` 9. Rising Temperature\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 import pandas as pd def rising_temperature(weather: pd.DataFrame) -\u003e pd.DataFrame: if weather.size: weather.sort_values(by=['recordDate'], inplace=True) weather.reset_index(inplace=True) weather.recordDate= pd.to_datetime(weather.recordDate, format=\"-%Y-%m-%d\") new_dates = pd.date_range(start=weather['recordDate'][0], end=weather['recordDate'][len(weather)-1],freq='D') weather = weather.set_index(\"recordDate\").reindex(new_dates).reset_index() weather.rename(columns={\"index\": \"recordDate\"}, inplace=True) weather[\"change\"] = weather.temperature - weather.temperature.shift(1, fill_value=weather.temperature[0]) return weather[weather[\"change\"] \u003e 0.0][[\"id\"]].rename(columns={\"id\": \"Id\"}) else: return weather[[\"id\"]].rename(columns={\"id\":\"ID\"}) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 WITH PreviousWeatherData AS ( SELECT id, recordDate, temperature, LAG(temperature, 1) OVER (ORDER BY recordDate) AS PreviousTemperature, LAG(recordDate, 1) OVER (ORDER BY recordDate) AS PreviousRecordDate FROM Weather ) SELECT id FROM PreviousWeatherData WHERE temperature \u003e PreviousTemperature AND recordDate = DATE_ADD(PreviousRecordDate, INTERVAL 1 DAY); This might be slower, as seen in leetcode.\n1 2 3 4 5 6 7 8 9 10 11 12 13 SELECT w1.id FROM Weather w1 WHERE w1.temperature \u003e ( SELECT w2.temperature FROM Weather w2 WHERE w2.recordDate = DATE_SUB(w1.recordDate, INTERVAL 1 DAY) ); 1 2 3 4 5 6 7 8 9 10 SELECT w1.id FROM Weather w1 JOIN Weather w2 ON DATEDIFF(w1.recordDate, w2.recordDate) = 1 WHERE w1.temperature \u003e w2.temperature; Bonus:\n1 2 3 4 5 6 select EmpLastName, EmpFirstName, ProjDesc, BldName, DeptName from Employee, Building, Department, Project where DeptBuilding = BldID and empDeptID = DeptID and EmpID = ProjManager order by EmpLastName, DeptName, BldName Multiple Tables could be used to join without using the word. Make sure to add where clause otherwise, data are added with each new row.\n1 2 3 4 5 6 from Department inner join employee inner join Building on empDeptID = DeptID and DeptBuilding = BldId order by DeptName, EmpSalary desc Average Time of Process per machine 1 2 3 4 5 select a1.machine_id, round(avg(a2.timestamp- a1.timestamp), 3) as processing_time from Activity a1 join Activity a2 on a1.machine_id = a2.machine_id and a1.process_id = a2.process_id and a1.timestamp \u003c a2.timestamp group by a1.machine_id Employee Bonus 1 2 3 4 5 select name, bonus from Employee left join Bonus on Employee.empId = Bonus.empId where Bonus.bonus \u003c 1000 or Bonus.bonus is null Students and Examinations 1 2 3 4 5 6 7 8 select S.student_id, S.student_name, SU.subject_name, COUNT(E.student_id) as attended_exams from Students S CROSS JOIN Subjects SU left join Examinations E on S.student_id = E.student_id AND SU.subject_name = E.subject_name Group By S.student_id, SU.subject_name ORDER BY s.student_id Managers with at least 5 direct reports 1 2 3 4 5 select b.name from Employee a Join Employee b on a.ManagerId = b.id group by a.ManagerId having count(*) \u003e= 5 Confirmation rate 1 2 3 4 5 select s.user_id, round(avg(if(c.action =\"confirmed\", 1, 0)), 2 ) as confirmation_rate from SignUps as s left join Confirmations as c on s.user_id = c.user_id group by user_id Not Boring Movie 1 2 3 4 select * from Cinema where description != \"boring\" and id%2 !=0 order by rating desc Average Selling Price 1 2 3 4 5 6 select P.product_id, ifnull(round(sum(US.units * P.price)/ sum(US.units), 2), 0) as average_price from Prices as P left join UnitsSold as US on US.product_id = P.product_id and US.purchase_date \u003e= P.start_date and US.purchase_date \u003c= P.end_date group by P.product_id Project employees Percentage of Users attended a contest Queries quality and Percentage Monthly Transactions I Immediate Food Delivery Game Play Analysis ","wordCount":"808","inLanguage":"en","image":"https://shekharkoirala.github.io/papermod-cover.png","datePublished":"2024-12-25T15:52:11Z","dateModified":"2024-12-25T15:52:11Z","author":{"@type":"Person","name":"shekhar"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://shekharkoirala.github.io/posts/sql_50/"},"publisher":{"@type":"Organization","name":"shekhar's Blog","logo":{"@type":"ImageObject","url":"https://shekharkoirala.github.io/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://shekharkoirala.github.io/ accesskey=h title="shekhar's Blog (Alt + H)">shekhar's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://shekharkoirala.github.io/archives title="Post üìù"><span>Post üìù</span></a></li><li><a href=https://shekharkoirala.github.io/categories/ title="Categories üîñ"><span>Categories üîñ</span></a></li><li><a href=https://shekharkoirala.github.io/tags/ title="Tags üè∑Ô∏è"><span>Tags üè∑Ô∏è</span></a></li><li><a href=https://shekharkoirala.github.io/about title="About üßò"><span>About üßò</span></a></li><li><a href=https://shekharkoirala.github.io/search/ title=üîç><span>üîç</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://shekharkoirala.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://shekharkoirala.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Top 50 SQL for Mastery</h1><div class=post-description>Top 50 SQl questions for your next interview, solutions included both Pandas and SQL</div><div class=post-meta><span title='2024-12-25 15:52:11 +0000 UTC'>December 25, 2024</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;shekhar&nbsp;|&nbsp;<a href=mailto:shekharkoirala4@gmail.com rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><ol><li><a href=https://leetcode.com/problems/recyclable-and-low-fat-products/>Recyclable and Low Fat Products</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_products</span><span class=p>(</span><span class=n>products</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># return products[(products[&#34;low_fats&#34;] == &#34;Y&#34;) &amp; (products[&#34;recyclable&#34;] ==&#34;Y&#34;)].loc[:,[&#34;product_id&#34;]]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>products</span><span class=p>[(</span><span class=n>products</span><span class=p>[</span><span class=s2>&#34;low_fats&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;Y&#34;</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>products</span><span class=p>[</span><span class=s2>&#34;recyclable&#34;</span><span class=p>]</span> <span class=o>==</span><span class=s2>&#34;Y&#34;</span><span class=p>)][[</span><span class=s2>&#34;product_id&#34;</span><span class=p>]]</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>product_id</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>Products</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>low_fats</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;Y&#34;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>recyclable</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;Y&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Note: can use df.iloc[:, [&ldquo;column_name&rdquo;]] or df[[&ldquo;column_name]]
df[&ldquo;column_name] returns series.</p><ol start=2><li><a href=https://leetcode.com/problems/find-customer-referee/>Find Customer Refree</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_customer_referee</span><span class=p>(</span><span class=n>customer</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>customer</span><span class=p>[(</span><span class=n>customer</span><span class=p>[</span><span class=s2>&#34;referee_id&#34;</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>2</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>customer</span><span class=p>[</span><span class=s2>&#34;referee_id&#34;</span><span class=p>]</span><span class=o>.</span><span class=n>isnull</span><span class=p>())][[</span><span class=s2>&#34;name&#34;</span><span class=p>]]</span>
</span></span></code></pre></td></tr></table></div></div><p>or</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>find_customer_referee</span><span class=p>(</span><span class=n>customer</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>customer</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>customer</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>customer</span><span class=p>[</span><span class=s2>&#34;referee_id&#34;</span><span class=p>]</span> <span class=o>!=</span><span class=mi>2</span> <span class=p>,</span> <span class=p>[</span><span class=s2>&#34;name&#34;</span><span class=p>]]</span>
</span></span></code></pre></td></tr></table></div></div><p>Note: can insert the logic in the loc</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>Customer</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>referee_id</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>referee_id</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=k>Null</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=3><li><a href=https://leetcode.com/problems/big-countries/?>Big countries</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>big_countries</span><span class=p>(</span><span class=n>world</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>world</span><span class=p>[(</span><span class=n>world</span><span class=p>[</span><span class=s2>&#34;area&#34;</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=mi>3000000</span><span class=p>)</span> <span class=o>|</span> <span class=p>(</span><span class=n>world</span><span class=p>[</span><span class=s2>&#34;population&#34;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mi>25000000</span><span class=p>)][[</span><span class=s2>&#34;name&#34;</span><span class=p>,</span> <span class=s2>&#34;population&#34;</span><span class=p>,</span> <span class=s2>&#34;area&#34;</span><span class=p>]]</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>population</span><span class=p>,</span><span class=w> </span><span class=n>area</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>world</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>population</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>25000000</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>area</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>3000000</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=4><li><a href=https://leetcode.com/problems/article-views-i/>Article View</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=k>def</span> <span class=nf>article_views</span><span class=p>(</span><span class=n>views</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>views</span><span class=p>[</span><span class=n>views</span><span class=p>[</span><span class=s2>&#34;viewer_id&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=n>views</span><span class=p>[</span><span class=s2>&#34;author_id&#34;</span><span class=p>]][[</span><span class=s2>&#34;author_id&#34;</span><span class=p>]]</span><span class=o>.</span><span class=n>drop_duplicates</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=s2>&#34;author_id&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;author_id&#34;</span><span class=p>:</span> <span class=s2>&#34;id&#34;</span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=k>distinct</span><span class=p>(</span><span class=n>author_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>Views</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>author_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>viewer_id</span><span class=w> </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>id</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=5><li><a href=https://leetcode.com/problems/invalid-tweets/>invalid tweets</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>tweet_id</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>Tweets</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=k>length</span><span class=p>(</span><span class=n>content</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=mi>15</span><span class=w> 
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>invalid_tweets</span><span class=p>(</span><span class=n>tweets</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span><span class=mi>22</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>tweets</span><span class=o>.</span><span class=n>query</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;content.str.len() &gt;15&#34;</span><span class=p>)[[</span><span class=s2>&#34;tweet_id&#34;</span><span class=p>]]</span>
</span></span></code></pre></td></tr></table></div></div><p>or</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=k>return</span> <span class=n>tweets</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>tweets</span><span class=o>.</span><span class=n>content</span><span class=o>.</span><span class=n>str</span><span class=o>.</span><span class=n>len</span><span class=p>()</span> <span class=o>&gt;</span><span class=mi>15</span><span class=p>,</span> <span class=p>[</span><span class=s2>&#34;tweet_id&#34;</span><span class=p>]]</span>
</span></span></code></pre></td></tr></table></div></div><ol start=6><li><a href=https://leetcode.com/problems/replace-employee-id-with-the-unique-identifier/>Replace Employee id</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>replace_employee_id</span><span class=p>(</span><span class=n>employees</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>,</span> <span class=n>employee_uni</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>pd</span><span class=o>.</span><span class=n>merge</span><span class=p>(</span><span class=n>employees</span><span class=p>,</span> <span class=n>employee_uni</span><span class=p>,</span> <span class=n>how</span><span class=o>=</span><span class=s2>&#34;left&#34;</span><span class=p>,</span> <span class=n>on</span><span class=o>=</span><span class=p>[</span><span class=s2>&#34;id&#34;</span><span class=p>,</span> <span class=s2>&#34;id&#34;</span><span class=p>])[[</span><span class=s2>&#34;unique_id&#34;</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=p>]]</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>unique_id</span><span class=p>,</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>Employees</span><span class=w> </span><span class=k>left</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>EmployeeUNI</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>Employees</span><span class=p>.</span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>EmployeeUNI</span><span class=p>.</span><span class=n>id</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=7><li><a href=https://leetcode.com/problems/product-sales-analysis-i/>Product Sales Analysis</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>product_name</span><span class=p>,</span><span class=w> </span><span class=k>year</span><span class=p>,</span><span class=w> </span><span class=n>price</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>Sales</span><span class=w> </span><span class=k>left</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>Product</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>Sales</span><span class=p>.</span><span class=n>product_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Product</span><span class=p>.</span><span class=n>product_id</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=8><li><a href=https://leetcode.com/problems/customer-who-visited-but-did-not-make-any-transactions>customer-who-visited-but-did-not-make-any-transactions</a><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>customer_id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>count_no_trans</span><span class=w> 
</span></span></span></code></pre></td></tr></table></div></div></li></ol><p>FROM
Visits
LEFT JOIN
Transactions
ON
Visits.visit_id = Transactions.visit_id
WHERE
transaction_id IS NULL
GROUP BY
customer_id;
```
9. <a href="https://leetcode.com/problems/rising-temperature/description/?envType=study-plan-v2&envId=top-sql-50">Rising Temperature</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pandas</span> <span class=k>as</span> <span class=nn>pd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>rising_temperature</span><span class=p>(</span><span class=n>weather</span><span class=p>:</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>weather</span><span class=o>.</span><span class=n>size</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>weather</span><span class=o>.</span><span class=n>sort_values</span><span class=p>(</span><span class=n>by</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;recordDate&#39;</span><span class=p>],</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>weather</span><span class=o>.</span><span class=n>reset_index</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>weather</span><span class=o>.</span><span class=n>recordDate</span><span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>weather</span><span class=o>.</span><span class=n>recordDate</span><span class=p>,</span> <span class=nb>format</span><span class=o>=</span><span class=s2>&#34;-%Y-%m-</span><span class=si>%d</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>new_dates</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>date_range</span><span class=p>(</span><span class=n>start</span><span class=o>=</span><span class=n>weather</span><span class=p>[</span><span class=s1>&#39;recordDate&#39;</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                                  <span class=n>end</span><span class=o>=</span><span class=n>weather</span><span class=p>[</span><span class=s1>&#39;recordDate&#39;</span><span class=p>][</span><span class=nb>len</span><span class=p>(</span><span class=n>weather</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span><span class=n>freq</span><span class=o>=</span><span class=s1>&#39;D&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>weather</span> <span class=o>=</span> <span class=n>weather</span><span class=o>.</span><span class=n>set_index</span><span class=p>(</span><span class=s2>&#34;recordDate&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>reindex</span><span class=p>(</span><span class=n>new_dates</span><span class=p>)</span><span class=o>.</span><span class=n>reset_index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>weather</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;index&#34;</span><span class=p>:</span> <span class=s2>&#34;recordDate&#34;</span><span class=p>},</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>weather</span><span class=p>[</span><span class=s2>&#34;change&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>weather</span><span class=o>.</span><span class=n>temperature</span> <span class=o>-</span> <span class=n>weather</span><span class=o>.</span><span class=n>temperature</span><span class=o>.</span><span class=n>shift</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>fill_value</span><span class=o>=</span><span class=n>weather</span><span class=o>.</span><span class=n>temperature</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>weather</span><span class=p>[</span><span class=n>weather</span><span class=p>[</span><span class=s2>&#34;change&#34;</span><span class=p>]</span> <span class=o>&gt;</span> <span class=mf>0.0</span><span class=p>][[</span><span class=s2>&#34;id&#34;</span><span class=p>]]</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;id&#34;</span><span class=p>:</span> <span class=s2>&#34;Id&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>weather</span><span class=p>[[</span><span class=s2>&#34;id&#34;</span><span class=p>]]</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=n>columns</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;id&#34;</span><span class=p>:</span><span class=s2>&#34;ID&#34;</span><span class=p>})</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>WITH</span><span class=w> </span><span class=n>PreviousWeatherData</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>id</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>recordDate</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>temperature</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>LAG</span><span class=p>(</span><span class=n>temperature</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>recordDate</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PreviousTemperature</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>LAG</span><span class=p>(</span><span class=n>recordDate</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>recordDate</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>PreviousRecordDate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>FROM</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Weather</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>PreviousWeatherData</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>temperature</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>PreviousTemperature</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>recordDate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DATE_ADD</span><span class=p>(</span><span class=n>PreviousRecordDate</span><span class=p>,</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>DAY</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>This might be slower, as seen in leetcode.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>w1</span><span class=p>.</span><span class=n>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Weather</span><span class=w> </span><span class=n>w1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>w1</span><span class=p>.</span><span class=n>temperature</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>w2</span><span class=p>.</span><span class=n>temperature</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>FROM</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>Weather</span><span class=w> </span><span class=n>w2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>WHERE</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>w2</span><span class=p>.</span><span class=n>recordDate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DATE_SUB</span><span class=p>(</span><span class=n>w1</span><span class=p>.</span><span class=n>recordDate</span><span class=p>,</span><span class=w> </span><span class=nb>INTERVAL</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>DAY</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>);</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=line><span class=cl><span class=k>SELECT</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>w1</span><span class=p>.</span><span class=n>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Weather</span><span class=w> </span><span class=n>w1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>JOIN</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>Weather</span><span class=w> </span><span class=n>w2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ON</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>DATEDIFF</span><span class=p>(</span><span class=n>w1</span><span class=p>.</span><span class=n>recordDate</span><span class=p>,</span><span class=w> </span><span class=n>w2</span><span class=p>.</span><span class=n>recordDate</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>w1</span><span class=p>.</span><span class=n>temperature</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>w2</span><span class=p>.</span><span class=n>temperature</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Bonus:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>EmpLastName</span><span class=p>,</span><span class=w> </span><span class=n>EmpFirstName</span><span class=p>,</span><span class=w> </span><span class=n>ProjDesc</span><span class=p>,</span><span class=w> </span><span class=n>BldName</span><span class=p>,</span><span class=w> </span><span class=n>DeptName</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>Employee</span><span class=p>,</span><span class=w> </span><span class=n>Building</span><span class=p>,</span><span class=w> </span><span class=n>Department</span><span class=p>,</span><span class=w> </span><span class=n>Project</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=n>DeptBuilding</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>BldID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>and</span><span class=w> </span><span class=n>empDeptID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>DeptID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>and</span><span class=w> </span><span class=n>EmpID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ProjManager</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>EmpLastName</span><span class=p>,</span><span class=w> </span><span class=n>DeptName</span><span class=p>,</span><span class=w> </span><span class=n>BldName</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>Multiple Tables could be used to join without using the word.
Make sure to add where clause otherwise, data are added with each new row.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from Department
</span></span><span class=line><span class=cl>inner join employee
</span></span><span class=line><span class=cl>inner join Building
</span></span><span class=line><span class=cl>on empDeptID = DeptID
</span></span><span class=line><span class=cl>and DeptBuilding = BldId
</span></span><span class=line><span class=cl>order by DeptName, EmpSalary desc
</span></span></code></pre></td></tr></table></div></div><ol start=10><li><a href=https://leetcode.com/problems/average-time-of-process-per-machine/description/>Average Time of Process per machine</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>a1</span><span class=p>.</span><span class=n>machine_id</span><span class=p>,</span><span class=w> </span><span class=n>round</span><span class=p>(</span><span class=k>avg</span><span class=p>(</span><span class=n>a2</span><span class=p>.</span><span class=k>timestamp</span><span class=o>-</span><span class=w> </span><span class=n>a1</span><span class=p>.</span><span class=k>timestamp</span><span class=p>),</span><span class=w> </span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>processing_time</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>Activity</span><span class=w> </span><span class=n>a1</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>join</span><span class=w> </span><span class=n>Activity</span><span class=w> </span><span class=n>a2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>on</span><span class=w> </span><span class=n>a1</span><span class=p>.</span><span class=n>machine_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a2</span><span class=p>.</span><span class=n>machine_id</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>a1</span><span class=p>.</span><span class=n>process_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>a2</span><span class=p>.</span><span class=n>process_id</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>a1</span><span class=p>.</span><span class=k>timestamp</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>a2</span><span class=p>.</span><span class=k>timestamp</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>a1</span><span class=p>.</span><span class=n>machine_id</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=11><li><a href=https://leetcode.com/problems/employee-bonus/submissions/>Employee Bonus</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>name</span><span class=p>,</span><span class=w> </span><span class=n>bonus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>Employee</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>left</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>Bonus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>on</span><span class=w> </span><span class=n>Employee</span><span class=p>.</span><span class=n>empId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Bonus</span><span class=p>.</span><span class=n>empId</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=n>Bonus</span><span class=p>.</span><span class=n>bonus</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>1000</span><span class=w> </span><span class=k>or</span><span class=w> </span><span class=n>Bonus</span><span class=p>.</span><span class=n>bonus</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=k>null</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=12><li><a href=https://leetcode.com/problems/students-and-examinations/>Students and Examinations</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>S</span><span class=p>.</span><span class=n>student_id</span><span class=p>,</span><span class=w> </span><span class=n>S</span><span class=p>.</span><span class=n>student_name</span><span class=p>,</span><span class=w> </span><span class=n>SU</span><span class=p>.</span><span class=n>subject_name</span><span class=p>,</span><span class=w> </span><span class=k>COUNT</span><span class=p>(</span><span class=n>E</span><span class=p>.</span><span class=n>student_id</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>attended_exams</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>Students</span><span class=w> </span><span class=n>S</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CROSS</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>Subjects</span><span class=w> </span><span class=n>SU</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>left</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>Examinations</span><span class=w> </span><span class=n>E</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>on</span><span class=w> </span><span class=n>S</span><span class=p>.</span><span class=n>student_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>E</span><span class=p>.</span><span class=n>student_id</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>AND</span><span class=w> </span><span class=n>SU</span><span class=p>.</span><span class=n>subject_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>E</span><span class=p>.</span><span class=n>subject_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Group</span><span class=w> </span><span class=k>By</span><span class=w> </span><span class=n>S</span><span class=p>.</span><span class=n>student_id</span><span class=p>,</span><span class=w> </span><span class=n>SU</span><span class=p>.</span><span class=n>subject_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=n>student_id</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=13><li><a href=https://leetcode.com/problems/managers-with-at-least-5-direct-reports/>Managers with at least 5 direct reports</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>Employee</span><span class=w> </span><span class=n>a</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Join</span><span class=w> </span><span class=n>Employee</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>ManagerId</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>b</span><span class=p>.</span><span class=n>id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>a</span><span class=p>.</span><span class=n>ManagerId</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>having</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>5</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=14><li><a href="https://leetcode.com/problems/confirmation-rate/submissions/1489282877/?envType=study-plan-v2&envId=top-sql-50">Confirmation rate</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=n>user_id</span><span class=p>,</span><span class=w> </span><span class=n>round</span><span class=p>(</span><span class=k>avg</span><span class=p>(</span><span class=k>if</span><span class=p>(</span><span class=k>c</span><span class=p>.</span><span class=n>action</span><span class=w> </span><span class=o>=</span><span class=s2>&#34;confirmed&#34;</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)),</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>confirmation_rate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>SignUps</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>left</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>Confirmations</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=k>c</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>on</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=n>user_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>c</span><span class=p>.</span><span class=n>user_id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>user_id</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=15><li><a href=https://leetcode.com/problems/not-boring-movies/>Not Boring Movie</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>Cinema</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>where</span><span class=w> </span><span class=n>description</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=s2>&#34;boring&#34;</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>id</span><span class=o>%</span><span class=mi>2</span><span class=w> </span><span class=o>!=</span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>rating</span><span class=w> </span><span class=k>desc</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=16><li><a href=https://leetcode.com/problems/average-selling-price/>Average Selling Price</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>select</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>product_id</span><span class=p>,</span><span class=w> </span><span class=n>ifnull</span><span class=p>(</span><span class=n>round</span><span class=p>(</span><span class=k>sum</span><span class=p>(</span><span class=n>US</span><span class=p>.</span><span class=n>units</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>price</span><span class=p>)</span><span class=o>/</span><span class=w> </span><span class=k>sum</span><span class=p>(</span><span class=n>US</span><span class=p>.</span><span class=n>units</span><span class=p>),</span><span class=w> </span><span class=mi>2</span><span class=p>),</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>average_price</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>from</span><span class=w> </span><span class=n>Prices</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>P</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>left</span><span class=w> </span><span class=k>join</span><span class=w> </span><span class=n>UnitsSold</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>US</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>on</span><span class=w> </span><span class=n>US</span><span class=p>.</span><span class=n>product_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>product_id</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=n>US</span><span class=p>.</span><span class=n>purchase_date</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>start_date</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>and</span><span class=w> </span><span class=n>US</span><span class=p>.</span><span class=n>purchase_date</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>end_date</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>product_id</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ol start=17><li><a href=https://leetcode.com/problems/project-employees-i/>Project employees</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql></code></pre></td></tr></table></div></div><ol start=18><li><a href=https://leetcode.com/problems/percentage-of-users-attended-a-contest/>Percentage of Users attended a contest</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql></code></pre></td></tr></table></div></div><ol start=19><li><a href=https://leetcode.com/problems/queries-quality-and-percentage/description/>Queries quality and Percentage</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql></code></pre></td></tr></table></div></div><ol start=20><li><a href=https://leetcode.com/problems/monthly-transactions-i>Monthly Transactions I</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL></code></pre></td></tr></table></div></div><ol start=21><li><a href=https://leetcode.com/problems/immediate-food-delivery-ii/>Immediate Food Delivery</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql></code></pre></td></tr></table></div></div><ol start=22><li><a href=https://leetcode.com/problems/game-play-analysis-iv/description/>Game Play Analysis</a></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://shekharkoirala.github.io/tags/sql/>Sql</a></li><li><a href=https://shekharkoirala.github.io/tags/pandas/>Pandas</a></li></ul><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Top 50 SQL for Mastery on x" href="https://x.com/intent/tweet/?text=Top%2050%20SQL%20for%20Mastery&amp;url=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fsql_50%2f&amp;hashtags=sql%2cpandas"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Top 50 SQL for Mastery on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fsql_50%2f&amp;title=Top%2050%20SQL%20for%20Mastery&amp;summary=Top%2050%20SQL%20for%20Mastery&amp;source=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fsql_50%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Top 50 SQL for Mastery on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fsql_50%2f&title=Top%2050%20SQL%20for%20Mastery"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Top 50 SQL for Mastery on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fsql_50%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Top 50 SQL for Mastery on whatsapp" href="https://api.whatsapp.com/send?text=Top%2050%20SQL%20for%20Mastery%20-%20https%3a%2f%2fshekharkoirala.github.io%2fposts%2fsql_50%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Top 50 SQL for Mastery on telegram" href="https://telegram.me/share/url?text=Top%2050%20SQL%20for%20Mastery&amp;url=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fsql_50%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Top 50 SQL for Mastery on ycombinator" href="https://news.ycombinator.com/submitlink?t=Top%2050%20SQL%20for%20Mastery&u=https%3a%2f%2fshekharkoirala.github.io%2fposts%2fsql_50%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>